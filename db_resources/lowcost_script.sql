-- MySQL Script generated by MySQL Workbench
-- Fri Mar 20 01:37:36 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema lowcost_schema
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `lowcost_schema` ;

-- -----------------------------------------------------
-- Schema lowcost_schema
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `lowcost_schema` DEFAULT CHARACTER SET utf8 ;
USE `lowcost_schema` ;

-- -----------------------------------------------------
-- Table `lowcost_schema`.`user_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`user_role` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`user_role` (
  `role_name` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`role_name`),
  UNIQUE INDEX `role_name_UNIQUE` (`role_name` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`airport_user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`airport_user` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`airport_user` (
  `email` VARCHAR(255) NOT NULL,
  `user_password` VARCHAR(255) NOT NULL,
  `first_name` VARCHAR(255) NOT NULL,
  `last_name` VARCHAR(255) NOT NULL,
  `role` VARCHAR(255) NOT NULL DEFAULT 'user',
  PRIMARY KEY (`email`),
  UNIQUE INDEX `email_UNIQUE` (`email` ASC) VISIBLE,
  INDEX `fk_airport_user_user_role1_idx` (`role` ASC) VISIBLE,
  CONSTRAINT `fk_airport_user_user_role1`
    FOREIGN KEY (`role`)
    REFERENCES `lowcost_schema`.`user_role` (`role_name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`plane`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`plane` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`plane` (
  `model` VARCHAR(255) NOT NULL,
  `places_quantity` INT NOT NULL,
  PRIMARY KEY (`model`),
  UNIQUE INDEX `model_UNIQUE` (`model` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`flight`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`flight` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`flight` (
  `number` VARCHAR(255) NOT NULL,
  `plane_model` VARCHAR(255) NOT NULL,
  `from` VARCHAR(255) NOT NULL,
  `to` VARCHAR(255) NOT NULL,
  `date` TIMESTAMP NOT NULL,
  `default_price` DECIMAL(5,2) NOT NULL,
  `default_luggage_kg` INT(11) NOT NULL,
  `available_places` INT NOT NULL,
  PRIMARY KEY (`number`),
  UNIQUE INDEX `number_UNIQUE` (`number` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`overweight_luggage_price`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`overweight_luggage_price` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`overweight_luggage_price` (
  `flight_number` VARCHAR(255) NOT NULL,
  `weight_from` INT NOT NULL,
  `weight_to` INT NOT NULL,
  `price_for_every_kg_overweight` INT NOT NULL,
  PRIMARY KEY (`flight_number`, `weight_from`, `weight_to`),
  INDEX `fk_overweight_luggage_price_flight1_idx` (`flight_number` ASC) VISIBLE,
  CONSTRAINT `fk_overweight_luggage_price_flight1`
    FOREIGN KEY (`flight_number`)
    REFERENCES `lowcost_schema`.`flight` (`number`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`ticket`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`ticket` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`ticket` (
  `ticket_number` VARCHAR(255) NOT NULL,
  `flight_number` VARCHAR(255) NOT NULL,
  `price` DECIMAL(7,2) NOT NULL,
  `luggage_quantity` INT(11) NOT NULL,
  `purchase_date` TIMESTAMP NOT NULL,
  `passenger_name` VARCHAR(255) NOT NULL,
  `flight_date` TIMESTAMP NOT NULL,
  `payment_status` TINYINT(1) NOT NULL,
  `ticket_status` TINYINT(1) NOT NULL,
  `primary_boarding_right` TINYINT(1) NOT NULL,
  `user_email` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`ticket_number`),
  UNIQUE INDEX `ticket_number_UNIQUE` (`ticket_number` ASC) VISIBLE,
  INDEX `fk_ticket_flight1_idx` (`flight_number` ASC) VISIBLE,
  INDEX `fk_ticket_airport_user1_idx` (`user_email` ASC) VISIBLE,
  CONSTRAINT `fk_ticket_flight1`
    FOREIGN KEY (`flight_number`)
    REFERENCES `lowcost_schema`.`flight` (`number`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ticket_airport_user1`
    FOREIGN KEY (`user_email`)
    REFERENCES `lowcost_schema`.`airport_user` (`email`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`date_coeff`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`date_coeff` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`date_coeff` (
  `flight_number` VARCHAR(255) NOT NULL,
  `days` INT NOT NULL,
  `coeff` DECIMAL(3,2) NOT NULL,
  PRIMARY KEY (`flight_number`, `days`),
  INDEX `fk_date_coeff_flight1_idx` (`flight_number` ASC) VISIBLE,
  CONSTRAINT `fk_date_coeff_flight1`
    FOREIGN KEY (`flight_number`)
    REFERENCES `lowcost_schema`.`flight` (`number`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`free_places_coeff`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`free_places_coeff` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`free_places_coeff` (
  `flight_number` VARCHAR(255) NOT NULL,
  `free_places_percent` INT NOT NULL,
  `coeff` DECIMAL(3,2) NOT NULL,
  PRIMARY KEY (`flight_number`, `free_places_percent`),
  INDEX `fk_free_places_coeff_flight1_idx` (`flight_number` ASC) VISIBLE,
  CONSTRAINT `fk_free_places_coeff_flight1`
    FOREIGN KEY (`flight_number`)
    REFERENCES `lowcost_schema`.`flight` (`number`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `lowcost_schema`.`flight_has_plane`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lowcost_schema`.`flight_has_plane` ;

CREATE TABLE IF NOT EXISTS `lowcost_schema`.`flight_has_plane` (
  `flight_number` VARCHAR(255) NOT NULL,
  `plane_model` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`flight_number`, `plane_model`),
  INDEX `fk_flight_has_plane_plane1_idx` (`plane_model` ASC) VISIBLE,
  INDEX `fk_flight_has_plane_flight1_idx` (`flight_number` ASC) VISIBLE,
  CONSTRAINT `fk_flight_has_plane_flight1`
    FOREIGN KEY (`flight_number`)
    REFERENCES `lowcost_schema`.`flight` (`number`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_flight_has_plane_plane1`
    FOREIGN KEY (`plane_model`)
    REFERENCES `lowcost_schema`.`plane` (`model`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`user_role`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`user_role` (`role_name`) VALUES ('admin');
INSERT INTO `lowcost_schema`.`user_role` (`role_name`) VALUES ('user');
INSERT INTO `lowcost_schema`.`user_role` (`role_name`) VALUES ('guest');

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`airport_user`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`airport_user` (`email`, `user_password`, `first_name`, `last_name`, `role`) VALUES ('admin@gmail.com', 'admin', 'Admin', 'Admin', 'admin');
INSERT INTO `lowcost_schema`.`airport_user` (`email`, `user_password`, `first_name`, `last_name`, `role`) VALUES ('user@gmail.com', 'user', 'User', 'User', 'user');
INSERT INTO `lowcost_schema`.`airport_user` (`email`, `user_password`, `first_name`, `last_name`, `role`) VALUES ('karpuwapower@gmail.com', 'Aliksei', 'Aliaksei', 'Karpilovich', DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`plane`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`plane` (`model`, `places_quantity`) VALUES ('boeing 737-700', 137);
INSERT INTO `lowcost_schema`.`plane` (`model`, `places_quantity`) VALUES ('boeing 737-800', 189);

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`flight`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`flight` (`number`, `plane_model`, `from`, `to`, `date`, `default_price`, `default_luggage_kg`, `available_places`) VALUES ('123', 'boeing 737-700', 'vilnus', 'amsterdam', '2020-05-06', 20, 5, 137);
INSERT INTO `lowcost_schema`.`flight` (`number`, `plane_model`, `from`, `to`, `date`, `default_price`, `default_luggage_kg`, `available_places`) VALUES ('abc', 'boeing 737-800', 'vilnus', 'prague', '2020-06-08', 15, 5, 189);

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`overweight_luggage_price`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('123', 5, 10, 4);
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('123', 10, 20, 15);
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('123', 20, 50, 40);
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('abc', 5, 15, 5);
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('abc', 15, 50, 30);
INSERT INTO `lowcost_schema`.`overweight_luggage_price` (`flight_number`, `weight_from`, `weight_to`, `price_for_every_kg_overweight`) VALUES ('abc', 50, 100, 100);

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`date_coeff`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('123', 100, 1);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('123', 20, 0.9);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('123', 10, 0.8);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('123', 5, 0.5);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('abc', 50, 1);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('abc', 20, 0.8);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('abc', 5, 0.5);
INSERT INTO `lowcost_schema`.`date_coeff` (`flight_number`, `days`, `coeff`) VALUES ('abc', 1, 0.3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `lowcost_schema`.`free_places_coeff`
-- -----------------------------------------------------
START TRANSACTION;
USE `lowcost_schema`;
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('123', 100, 1);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('123', 20, 0.9);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('123', 10, 0.8);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('123', 5, 0.75);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('abc', 100, 1);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('abc', 10, 0.95);
INSERT INTO `lowcost_schema`.`free_places_coeff` (`flight_number`, `free_places_percent`, `coeff`) VALUES ('abc', 5, 0.8);

COMMIT;

